#!/bin/bash

start=$SECONDS
count=0

function clean() {
  for d in $1; do
    if [ -f "$d/Cargo.toml" ]; then
      echo "[~] Cleaning $(basename "$d")"
      cd "$d" && cargo clean
      ((count += 1))
    fi
  done
}

function main() {
  clean "$(fd -a . "$HOME"/src -d 1)"
  clean "$(fd -a . "$HOME"/fun -d 1)"
  echo "Cleaned $count projects in $((SECONDS - start))s."
}

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
  main
fi
